<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Position - Islamic Insurance Company</title>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/swiper-bundle.min.css">
    <link rel="stylesheet" href="./css/intlTelInput.min.css">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/all.min.css">
    <link rel="stylesheet" href="./css/style_front.css">
    <link rel="stylesheet" href="./css/navbar.css">
    <link rel="stylesheet" href="./css/footer.css">
    <link rel="stylesheet" href="./css/forms.css">
    <link rel="stylesheet" href="./css/job-detail.css">
    <link rel="stylesheet" href="./css/custom.css">

    <!-- Js -->
    <script src="./js/jquery-3.7.1.js"></script>
    <script src="./js/bootstrap.bundle.min.js"></script>
    <script src="./js/swiper-bundle.min.js"></script>
    <script src="./js/intlTelInputWithUtils.min.js"></script>
    <script src="./js/lucide.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/navbar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-white">

    <!-- Start Navbar -->
    <header class="py-3 d-flex flex-column justify-content-center align-items-center">
        <div
            class="container navbar-container d-inline-flex flex-xl-row flex-column-reverse justify-content-between align-items-stretch gap-3">
            <picture class="logo-img">
                <img src="./assets/images/logo-nav.png" alt="" class=" default-image-class">
            </picture>
            <!-- Navbar links -->
            <nav class="navbar navbar-expand-xl w-100">
                <button id="toggleButton" class="navbar-toggler border-0" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fa-solid fa-bars" id="openIcon"></i>
                    <i class="fa-solid fa-xmark primary-color d-none" id="closeIcon"></i>
                </button>
                <div class="navbar-collapse-container d-flex align-items-center justify-content-between w-100">
                    <div class="collapse navbar-collapse justify-content-center" id="navbarSupportedContent">
                        <ul class="navbar-nav mb-lg-0 custom-nav">
                            <li class="nav-item container">
                                <a href="./home.html" class="nav-link small-screen p-title">Home</a>
                            </li>
                            <!-- About -->
                            <li
                                class="nav-item dropdown-menu-news-li-parent nav-link d-flex justify-content-between align-items-center w-100 flex-wrap container relative">
                                <a href="#" class="custom-dropdown anchor-none p-title d-flex align-items-center">
                                    About Us
                                    <i class="fa-solid fa-chevron-down"></i>
                                </a>
                                <button class="toggleButtonHeader d-xl-none  px-3">
                                    <i class="fa-solid fa-plus"></i>
                                    <i class="fa-solid fa-minus"></i>
                                </button>
                                <div class="dropdown-menu-news">
                                    <ul>
                                        <li><a href="/news/local">Local News</a></li>
                                        <li><a href="/news/world">World News</a></li>
                                        <li><a href="/news/sports">Sports</a></li>
                                    </ul>
                                </div>
                            </li>
                            <li class="nav-item container">
                                <a href="./our-work.html" class="nav-link small-screen p-title">Our Work</a>
                            </li>
                            <li class="nav-item container">
                                <a href="./our-work-inner.html" class="nav-link small-screen p-title">Projects</a>
                            </li>
                            <li class="nav-item container">
                                <a href="./clients-partners.html" class="nav-link small-screen p-title">client &
                                    Partners</a>
                            </li>
                            <li class="nav-item container">
                                <a href="./join-us.html" class="nav-link small-screen p-title">Join Us</a>
                            </li>
                            <!-- Contact -->
                            <li class="nav-item container">
                                <a href="/contact" class="nav-link small-screen p-title">Contact Us</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="d-flex justify-content-between align-items-center px-3 px-xl-0">
                <div>
                    <a href="#">
                        <picture class="mobile logo-img">
                            <img src="./assets/images/logo-nav.png" alt="" class=" default-image-class">
                        </picture>
                    </a>
                </div>
                <div class="d-flex justify-content-center align-items-center gap-3">
                    <a href="#" class="outlined-btn px-2 px-xl-3 py-2 search-btn">
                        <span>
                            Search
                        </span>
                        <i data-lucide="search"></i>
                    </a>
                    <a href="#" class="d-flex align-items-center gap-2 language-toggle-btn">
                        <i data-lucide="globe" class="text-black"></i>
                    </a>
                </div>
            </div>
        </div>
    </header>
    <!-- Search Container -->
    <div class="search-nav-container overflow-hidden">
        <div class="searchBarOpen">
            <form class="searchBarOpen--input" id="custom-search-form">
                <div class="d-flex align-items-center gap-2">
                    <input type="text" name="title" id="search-title-input" required placeholder="Search Here"
                        data-url-name="title" />
                    <button>
                        <i data-lucide="search"></i>
                    </button>
                </div>
            </form>
            <span class="searchBarOpen--closeBtn"><i class="fa-solid fa-x"></i></span>
        </div>
    </div>
    <!-- End Navbar -->

    <!-- Loading State -->
    <div id="loading" class="py-6 text-center">
        <div class="spinner-border text-primary-color" role="status"></div>
        <p class="mt-3 text-center text-gray-color">Loading job details...</p>
    </div>

    <!-- Error State -->
    <div id="error" class="d-none py-6 text-center">
        <div class="error-container d-flex flex-column align-items-center mx-auto px-3">
            <i data-lucide="alert-circle" class="mx-auto text-danger mb-3"></i>
            <h2 class="text-secondary-color mb-3">Job Position Not Found</h2>
            <p class="text-gray-color mb-4">The job position you're looking for could not be found or is no longer available.</p>
            <a href="careers.html" class="main-btn w-fit">Back to Careers</a>
        </div>
    </div>

    <!-- Job Content -->
    <div id="job-content" class="d-none">
        <!-- Breadcrumb -->
        <div class="bg-soft-white py-3">
            <div class="container">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="index.html" class="text-gray-color">Home</a></li>
                        <li class="breadcrumb-item"><a href="careers.html" class="text-gray-color">Careers</a></li>
                        <li class="breadcrumb-item current-page text-primary-color" aria-current="page">Job Details</li>
                    </ol>
                </nav>
            </div>
        </div>

        <!-- Job Header -->
        <section class="job-header py-5 bg-white">
            <div class="container">
                <div class="d-flex align-items-center gap-3 mb-4">
                    <a href="careers.html" class="back-btn d-inline-flex align-items-center gap-2 text-primary-color">
                        <i data-lucide="arrow-left"></i>
                        Back to Careers
                    </a>
                </div>

                <div class="d-flex flex-column flex-lg-row align-items-lg-start justify-content-lg-between gap-4">
                    <div class="flex-fill">
                        <div class="d-flex align-items-center flex-wrap gap-3 mb-3">
                            <h1 id="job-title" class="text-secondary-color"></h1>
                            <span id="employment-badge" class="bg-primary-color text-white px-3 py-1 rounded-pill"></span>
                        </div>
                        <h2 id="job-title-ar" class="text-gray-color mb-4" dir="rtl"></h2>

                        <div class="job-info d-flex flex-wrap gap-4 text-gray-color mb-4">
                            <div class="d-flex align-items-center gap-2">
                                <i data-lucide="map-pin"></i>
                                <span id="job-location"></span>
                            </div>
                            <div class="d-flex align-items-center gap-2">
                                <i data-lucide="briefcase"></i>
                                <span id="job-department"></span>
                            </div>
                            <div class="d-flex align-items-center gap-2">
                                <i data-lucide="clock"></i>
                                <span id="job-posted"></span>
                            </div>
                        </div>
                    </div>

                    <div class="job-action-buttons d-flex flex-column align-items-center gap-3">
                        <button onclick="applyNow()" class="main-btn w-100">
                            Apply Now
                        </button>
                        <button onclick="shareJob()" class="outlined-btn w-100">
                            <i data-lucide="share-2"></i>
                            Share Job
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Job Details -->
        <section class="job-details-section py-5 bg-soft-white">
            <div class="container">
                <div class="row gy-4 gy-lg-0 gx-0 gx-lg-4">
                    <!-- Main Content -->
                    <div class="col-lg-8 d-flex flex-column gap-4">
                        <!-- Description -->
                        <div class="Job-section-card bg-white rounded-3 shadow-sm p-4">
                            <h3 class="text-secondary-color mb-4">Job Description</h3>
                            <div id="job-description" class="text-dark-gray"></div>
                        </div>

                        <!-- Description Arabic -->
                        <div class="Job-section-card bg-white rounded-3 shadow-sm p-4" dir="rtl">
                            <h3 class="text-secondary-color mb-4">الوصف الوظيفي</h3>
                            <div id="job-description-ar" class="text-dark-gray"></div>
                        </div>

                        <!-- Requirements -->
                        <div class="Job-section-card bg-white rounded-3 shadow-sm p-4">
                            <h3 class="text-secondary-color mb-4">Requirements & Qualifications</h3>
                            <div id="job-requirements" class="text-dark-gray"></div>
                        </div>

                        <!-- Requirements Arabic -->
                        <div class="Job-section-card bg-white rounded-3 shadow-sm p-4" dir="rtl">
                            <h3 class="text-secondary-color mb-4">المتطلبات والمؤهلات</h3>
                            <div id="job-requirements-ar" class="text-dark-gray"></div>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="sidebar col-lg-4 d-flex flex-column gap-4">
                        <!-- Apply Card -->
                        <div class="apply-card bg-white rounded-3 shadow-sm p-4 position-sticky">
                            <h4 class="text-secondary-color mb-3">Interested in this position?</h4>
                            <p class="text-gray-color mb-4">Submit your application and join our team at Islamic Insurance Company.</p>
                            <button onclick="applyNow()" class="main-btn w-100 mb-3">
                                Apply Now
                            </button>
                            <a href="careers.html" class="view-all-btn d-block text-center text-primary-color">View All Positions</a>
                        </div>

                        <!-- Company Info -->
                        <div class="company-info-card bg-white rounded-3 shadow-sm p-4">
                            <h4 class="text-secondary-color mb-3">About Us</h4>
                            <p class="text-gray-color mb-3">Islamic Insurance Company is Jordan's leading Takaful insurance provider, committed to delivering ethical insurance solutions based on Islamic principles.</p>
                            <a href="about.html" class="learn-more-btn d-inline-flex align-items-center gap-2 text-primary-color">
                                Learn More
                                <i data-lucide="arrow-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Similar Positions -->
        <section class="similar-positions-section py-5 bg-white">
            <div class="container">
                <h2 class="text-secondary-color mb-4">Similar Positions</h2>
                <div id="similar-jobs" class="d-flex flex-column gap-3">
                </div>
            </div>
        </section>
    </div>

    <!-- Start Footer -->
        <footer class="main-footer-container">
            <div class="container footer-section py-4">
                <div class="row gy-4 gy-md-0 gx-0 gx-md-4">
                    <div class="col-lg-3 footer-item pt-0 pt-md-4">
                    <div class="logo-container mb-2">
                        <img src="./assets/images/logo whitepng.png" alt="Logo" class="default-image-class">
                    </div>
                    <div class="footer-item-header d-flex align-items-start justify-content-between">
                        <h5 class="text-white">The Islamic Insurance</h5>
                        <button class="toggleButton mobile-responsive" data-target="about">
                            <i class="fa-solid fa-plus"></i>
                            <i class="fa-solid fa-minus" style="display: none"></i>
                        </button>
                    </div>
                    <ul id="about" class="list-unstyled py-2">
                        <li class="pb-2 mb-0">
                            <span>Islamic Insurance Company is the first Islamic Takaful insurance company in Jordan, founded in 1996. It operates in accordance with the provisions of Islamic Sharia.</span>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-3 footer-item pt-0 pt-md-4">
                    <div class="footer-item-header d-flex align-items-start justify-content-between">
                        <h5 class="text-white">Takaful Products</h5>
                        <button class="toggleButton mobile-responsive" data-target="products">
                            <i class="fa-solid fa-plus"></i>
                            <i class="fa-solid fa-minus" style="display: none"></i>
                        </button>
                    </div>
                    <ul id="products" class="list-unstyled py-2">
                        <li class="pb-2 mb-0">
                            <a href=""> Our Vision</a>
                        </li>
                        <li class="pb-2 mb-0"><a href=""> Board of Directors </a></li>
                        <li class="pb-2 mb-0"><a href="">Management Team </a></li>
                        <li class="pb-2 mb-0"><a href=""> Products and Services </a></li>
                        <li class="pb-2 mb-0"><a href="">Pricing and Fees List </a></li>
                        <li class="pb-2 mb-0"><a href="">Branches</a></li>
                        <li class="pb-2 mb-0"><a href="">Corporate Governance</a></li>
                        <li class="pb-2 mb-0"><a href="">Central Bank of Jordan
                                Instructions </a></li>
                        <li class="pb-2 mb-0"><a href="#" class="underline hover:no-underline">View All</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 footer-item pt-0 pt-md-4">
                    <div class="footer-item-header d-flex align-items-start justify-content-between">
                        <h5 class="text-white">Useful Links</h5>
                        <button class="toggleButton mobile-responsive" data-target="useful-links">
                            <i class="fa-solid fa-plus"></i>
                            <i class="fa-solid fa-minus" style="display: none"></i>
                        </button>
                    </div>
                    <ul id="useful-links" class="list-unstyled py-2">
                        <li class="pb-2 mb-0">
                            <a href=""> FAQs </a>
                        </li>
                        <li class="pb-2 mb-0"><a href="">Customer Complaints Channels </a></li>
                        <li class="pb-2 mb-0"><a href=""> Apply a Complaint</a></li>
                        <li class="pb-2 mb-0"><a href=""> Vacancies</a></li>
                        <li class="pb-2 mb-0"><a href=""> Job Application</a></li>
                        <li class="pb-2 mb-0"><a href=""> Site Map</a></li>
                        <li class="pb-2 mb-0"><a href=""> Marketing campaigns
                                and rearwards</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 footer-item pt-0 pt-md-4">
                    <div class="footer-item-header d-flex align-items-start justify-content-between">
                        <h5 class="text-white">Contact Us</h5>
                        <button class="toggleButton mobile-responsive" data-target="contact-us">
                            <i class="fa-solid fa-plus"></i>
                            <i class="fa-solid fa-minus" style="display: none"></i>
                        </button>
                    </div>
                    <ul id="contact-us" class="list-unstyled contact-info-list py-2">
                        <li class="d-flex align-items-start gap-2">
                            <div>
                                <i data-lucide="phone" class="text-white"></i>
                            </div>
                            <a href="#" class="d-flex align-items-center gap-1 flex-wrap">
                                <span>Phone:</span>
                                <span dir="ltr">06-562-0151</span>
                            </a>
                        </li>
                        <li class="d-flex align-items-start gap-2">
                            <div>
                                <i data-lucide="map-pin" class="text-white"></i>
                            </div>
                            <a href="#" class="d-flex align-items-center gap-1 flex-wrap">
                                <span>Wasfi Al-Tal Street (Al Gardens) – Islamic Insurance Complex (94)</span>
                            </a>
                        </li>
                        <li class="d-flex align-items-start gap-2">
                            <div>
                                <i data-lucide="mail" class="text-white"></i>
                            </div>
                            <a href="#" class="d-flex align-items-center gap-1 flex-wrap">
                                <span>islamicinsurance@tiic.com.jo</span>
                            </a>
                        </li>
                        <li class="d-flex align-items-start gap-2">
                            <div>
                                <i data-lucide="mailbox" class="text-white"></i>
                            </div>
                            <a href="#" class="d-flex align-items-center gap-1 flex-wrap">
                                <span>P.O.Box (941000) Amman 11194 – Jordan</span>
                            </a>
                        </li>
                        <li class="d-flex align-items-start gap-2">
                            <div>
                                <i data-lucide="stethoscope" class="text-white"></i>
                            </div>
                            <a href="#" class="d-flex align-items-center gap-1 flex-wrap">
                                <span>Medical Approvals:</span>
                                <span dir="ltr">06-566-1300</span>
                            </a>
                        </li>
                    </ul>
                </div>
                </div>
            </div>
            <div class="footer-copyright-container m-0">
                <div class="footer-copyright-container-centered container py-4">
                    <div>
                        <p class="text-center text-black mb-0">© 2025 Developed by dot jo. All rights reserved.</p>
                    </div>
                    <div class="d-flex justify-content-center align-items-center gap-2">
                        <a href="#"><i data-lucide="facebook"></i></a>
                        <a href="#"><i data-lucide="instagram"></i></a>
                        <a href="#"><i data-lucide="linkedin"></i></a>
                        <a href="#"><i data-lucide="twitter"></i></a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- End Footer -->

    <script>
        const SUPABASE_URL = 'https://jassfnwuhtddwqzloxci.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imphc3Nmbnd1aHRkZHdxemxveGNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4MjI0ODQsImV4cCI6MjA3NzM5ODQ4NH0.xx373opRUSa1yS1og8_TDx5F3Lrix4PSkybhU_XPD88';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        lucide.createIcons();

        function getJobSlug() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('slug');
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const today = new Date();
            const diffTime = Math.abs(today - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 0) return 'Posted today';
            if (diffDays === 1) return 'Posted 1 day ago';
            if (diffDays < 7) return `Posted ${diffDays} days ago`;
            if (diffDays < 14) return 'Posted 1 week ago';
            if (diffDays < 30) return `Posted ${Math.floor(diffDays / 7)} weeks ago`;
            return `Posted ${Math.floor(diffDays / 30)} month${Math.floor(diffDays / 30) > 1 ? 's' : ''} ago`;
        }

        function formatContent(text) {
            return text.split('\n\n').map(section => {
                if (section.includes('•')) {
                    const lines = section.split('\n');
                    const title = lines[0];
                    const items = lines.slice(1).filter(l => l.trim());
                    return `<p class="mb-2">${title}</p><ul class="requirements-list mb-3">${items.map(item => `<li>${item.replace('•', '').trim()}</li>`).join('')}</ul>`;
                }
                return `<p>${section}</p>`;
            }).join('');
        }

        window.applyNow = function() {
            const jobTitle = document.getElementById('job-title').textContent;
            const subject = encodeURIComponent(`Job Application: ${jobTitle}`);
            const body = encodeURIComponent(`Dear Hiring Manager,\n\nI am interested in applying for the ${jobTitle} position at Islamic Insurance Company.\n\nBest regards`);
            window.location.href = `mailto:hr@tiic.com.jo?subject=${subject}&body=${body}`;
        }

        window.shareJob = function() {
            if (navigator.share) {
                navigator.share({
                    title: document.getElementById('job-title').textContent,
                    text: document.getElementById('job-description').textContent.substring(0, 100) + '...',
                    url: window.location.href
                }).catch(() => {});
            } else {
                navigator.clipboard.writeText(window.location.href);
                alert('Link copied to clipboard!');
            }
        }

        async function loadJob() {
            const slug = getJobSlug();

            if (!slug) {
                showError();
                return;
            }

            try {
                const { data: job, error } = await supabase
                    .from('job_positions')
                    .select('*')
                    .eq('slug', slug)
                    .eq('is_active', true)
                    .maybeSingle();

                if (error || !job) {
                    showError();
                    return;
                }

                displayJob(job);
                loadSimilarJobs(job.department, job.id);
            } catch (error) {
                console.error('Error loading job:', error);
                showError();
            }
        }

        function displayJob(job) {
            document.getElementById('loading').classList.add('d-none');
            document.getElementById('job-content').classList.remove('d-none');

            document.getElementById('job-title').textContent = job.title;
            document.getElementById('job-title-ar').textContent = job.title_ar || job.title;
            document.getElementById('employment-badge').textContent = job.employment_type;
            document.getElementById('job-location').textContent = job.location;
            document.getElementById('job-department').textContent = job.department + ' Department';
            document.getElementById('job-posted').textContent = formatDate(job.posted_date);

            document.getElementById('job-description').innerHTML = formatContent(job.full_description);
            document.getElementById('job-description-ar').innerHTML = formatContent(job.full_description_ar || job.full_description);
            document.getElementById('job-requirements').innerHTML = formatContent(job.requirements);
            document.getElementById('job-requirements-ar').innerHTML = formatContent(job.requirements_ar || job.requirements);

            document.title = `${job.title} - Islamic Insurance Company`;

            lucide.createIcons();
        }

        async function loadSimilarJobs(department, currentId) {
            try {
                const { data: jobs, error } = await supabase
                    .from('job_positions')
                    .select('*')
                    .eq('is_active', true)
                    .neq('id', currentId)
                    .limit(3);

                if (error) throw error;

                const similarContainer = document.getElementById('similar-jobs');
                similarContainer.innerHTML = jobs.map(job => `
                    <div class="job-card p-4">
                        <div class="d-flex flex-column justify-content-lg-between align-items-lg-center flex-lg-row gap-3">
                            <div class="job-card-content">
                                <div class="d-flex flex-column flex-sm-row align-items-sm-center gap-1 mb-2 gap-sm-3">
                                    <h3 class="text-secondary-color">${job.title}</h3>
                                    <span class="bg-primary-color text-white px-3 py-1 rounded-pill w-fit">${job.employment_type}</span>
                                </div>
                                <p class="text-gray-color mb-3">${job.description}</p>
                                <div class="card-icons-container d-flex flex-wrap gap-3 text-silver-color">
                                    <span class="d-flex align-items-center gap-1">
                                        <i data-lucide="map-pin"></i>
                                        ${job.location}
                                    </span>
                                    <span class="d-flex align-items-center gap-1">
                                        <i data-lucide="briefcase"></i>
                                        ${job.department} Department
                                    </span>
                                    <span class="d-flex align-items-center gap-1">
                                        <i data-lucide="clock"></i>
                                        ${formatDate(job.posted_date)}
                                    </span>
                                </div>
                            </div>
                            <div class="d-flex gap-3 flex-column flex-sm-row">
                                <a href="job-detail.html?slug=${job.slug}" class="outlined-btn w-sm-100 px-4 py-2">View Details</a>
                                <button onclick="applyNow()" class="main-btn w-sm-100 px-4 py-2">Apply Now</button>
                            </div>
                        </div>
                    </div>
                `).join('');

                lucide.createIcons();
            } catch (error) {
                console.error('Error loading similar jobs:', error);
            }
        }

        function showError() {
            document.getElementById('loading').classList.add('d-none');
            document.getElementById('error').classList.remove('d-none');
            lucide.createIcons();
        }

        loadJob();
    </script>
</body>
</html>
